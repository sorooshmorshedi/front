(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4660eb5a"],{3664:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("m-form",{attrs:{title:"",showList:!1,isEditing:t.isEditing,canDelete:t.canDelete,canSubmit:t.canSubmit,confirmBtnText:t.confirmBtnText,cancelConfirmBtnText:t.cancelConfirmBtnText,canConfirm:t.canConfirm,canCancelConfirm:t.canCancelConfirm},on:{"update:isEditing":function(e){t.isEditing=e},"update:is-editing":function(e){t.isEditing=e},cancelConfirm:t.cancelConfirm,confirm:t.confirm,goToForm:t.getItemByPosition,submit:t.submit,delete:t.deleteItem,clearForm:function(e){return t.clearForm(!0)}},scopedSlots:t._u([{key:"header-btns",fn:function(){return[t.item.sanad?i("open-sanad-btn",{attrs:{sanad:t.item.sanad}}):t._e()]},proxy:!0}])},[[i("v-row",[i("v-col",{attrs:{cols:"12",md:"2"}},[i("v-text-field",{attrs:{label:"عطف",disabled:!0},model:{value:t.item.id,callback:function(e){t.$set(t.item,"id",e)},expression:"item.id"}})],1),i("v-col",{attrs:{cols:"12",md:"4"}},[i("v-autocomplete",{attrs:{"return-object":!0,label:"حمل کننده",items:t.$store.state.drivings,"item-text":"title","item-value":"id",disabled:!t.isEditing},model:{value:t.item.driving,callback:function(e){t.$set(t.item,"driving",e)},expression:"item.driving"}})],1),i("v-col",{attrs:{cols:"12",md:"2"}},[i("v-autocomplete",{attrs:{"return-object":!1,label:"نوع بارگیری",disabled:!t.isEditing,items:t.types,"item-value":"id"},model:{value:t.item.type,callback:function(e){t.$set(t.item,"type",e)},expression:"item.type"}})],1)],1),t.item.type.includes("l")?i("v-row",[i("v-col",{attrs:{cols:"12"}},[i("v-card-title",{staticClass:"py-0"},[t._v("بارگیری")])],1),[i("v-col",{attrs:{cols:"12",md:"2"}},[i("v-autocomplete",{attrs:{"return-object":!0,label:"شماره حواله",disabled:!t.isEditing,items:t.remittances,"search-input":t.remittanceSearch,"item-text":"code","item-value":"id",clearable:""},on:{"update:searchInput":function(e){t.remittanceSearch=e},"update:search-input":function(e){t.remittanceSearch=e}},model:{value:t.remittance,callback:function(e){t.remittance=e},expression:"remittance"}})],1),i("v-col",{attrs:{cols:"12",md:"3"}},[i("v-text-field",{attrs:{label:"شماره بارگیری",disabled:!t.isEditing},model:{value:t.item.lading_number,callback:function(e){t.$set(t.item,"lading_number",e)},expression:"item.lading_number"}})],1),i("v-col",{attrs:{cols:"12",md:"3"}},[i("date",{attrs:{label:"تاریخ بارگیری",default:!0,disabled:!t.isEditing},model:{value:t.item.lading_date,callback:function(e){t.$set(t.item,"lading_date",e)},expression:"item.lading_date"}})],1),i("v-col",{attrs:{cols:"12",md:"3"}},[i("ware-select",{attrs:{label:"کالا",disabled:!t.isEditing},model:{value:t.item.ware,callback:function(e){t.$set(t.item,"ware",e)},expression:"item.ware"}})],1),i("v-col",{attrs:{cols:"12",md:"3"}},[i("account-select",{attrs:{label:"پیمانکار",disabled:!t.isEditing,"items-type":"level3"},model:{value:t.item.contractor,callback:function(e){t.$set(t.item,"contractor",e)},expression:"item.contractor"}})],1),i("v-col",{attrs:{cols:"12",md:"2"}},[i("money",{attrs:{label:"نرخ حواله پیمانکار",disabled:!t.isEditing},model:{value:t.item.contractor_price,callback:function(e){t.$set(t.item,"contractor_price",e)},expression:"item.contractor_price"}})],1),i("v-col",{attrs:{cols:"12",md:"2"}},[i("money",{attrs:{label:"نرخ کرایه",disabled:!t.isEditing},model:{value:t.item.fare_price,callback:function(e){t.$set(t.item,"fare_price",e)},expression:"item.fare_price"}})],1),i("v-col",{attrs:{cols:"12",md:"2"}},[i("money",{attrs:{label:"فی کمیسیون",disabled:!0},model:{value:+t.item.contractor_price-+t.item.fare_price,callback:function(e){t.$set(+t.item.contractor_price-+t.item,"fare_price",e)},expression:"+item.contractor_price - +item.fare_price"}})],1),i("v-col",{attrs:{cols:"12",md:"2"}},[i("money",{attrs:{label:"انعام راننده",disabled:!t.isEditing},model:{value:t.item.driver_tip_price,callback:function(e){t.$set(t.item,"driver_tip_price",e)},expression:"item.driver_tip_price"}})],1),i("v-col",{attrs:{cols:"12",md:"2"}},[i("v-autocomplete",{attrs:{"return-object":!0,label:"پرداخت کننده انعام",items:t.tipPayers,disabled:!t.isEditing,"item-text":"title","item-value":"id"},model:{value:t.item.driver_tip_payer,callback:function(e){t.$set(t.item,"driver_tip_payer",e)},expression:"item.driver_tip_payer"}})],1),i("v-col",{attrs:{cols:"12",md:"2"}},[i("money",{attrs:{label:"مبلغ اختلاف بارنامه",disabled:!t.isEditing},model:{value:t.item.lading_bill_difference,callback:function(e){t.$set(t.item,"lading_bill_difference",e)},expression:"item.lading_bill_difference"}})],1),i("v-col",{attrs:{cols:"12",md:"2"}},[i("v-autocomplete",{attrs:{"return-object":!1,label:"روش پرداخت مبلغ حواله",items:t.remittancePaymentMethods,disabled:!t.isEditing},model:{value:t.item.remittance_payment_method,callback:function(e){t.$set(t.item,"remittance_payment_method",e)},expression:"item.remittance_payment_method"}})],1),i("v-col",{attrs:{cols:"12",md:"2"}},[i("money",{attrs:{label:"مقدار بارنامه مبدا",disabled:!t.isEditing},on:{input:function(e){!t.is_destination_amount_dirty&&(t.item.destination_amount=t.item.origin_amount)}},model:{value:t.item.origin_amount,callback:function(e){t.$set(t.item,"origin_amount",e)},expression:"item.origin_amount"}})],1),i("v-col",{attrs:{cols:"12",md:"2"}},[i("money",{attrs:{label:"مقدار بارنامه مقصد",disabled:!t.isEditing},on:{input:function(e){t.is_destination_amount_dirty=!0}},model:{value:t.item.destination_amount,callback:function(e){t.$set(t.item,"destination_amount",e)},expression:"item.destination_amount"}})],1),i("v-col",{attrs:{cols:"12",md:"2"}},[i("city-select",{attrs:{label:"مبدا",disabled:!t.isEditing},model:{value:t.item.origin,callback:function(e){t.$set(t.item,"origin",e)},expression:"item.origin"}})],1),i("v-col",{attrs:{cols:"12",md:"2"}},[i("city-select",{attrs:{label:"مقصد",disabled:!t.isEditing},model:{value:t.item.destination,callback:function(e){t.$set(t.item,"destination",e)},expression:"item.destination"}})],1),i("v-col",{attrs:{cols:"12",md:"2"}},[i("m-file-input",{attrs:{label:"فایل",disabled:!t.isEditing,"delete-attachment":t.item.delete_lading_attachment},on:{"update:deleteAttachment":function(e){return t.$set(t.item,"delete_lading_attachment",e)},"update:delete-attachment":function(e){return t.$set(t.item,"delete_lading_attachment",e)}},model:{value:t.item.lading_attachment,callback:function(e){t.$set(t.item,"lading_attachment",e)},expression:"item.lading_attachment"}})],1),i("v-col",{attrs:{cols:"12",md:"2"}},[i("v-autocomplete",{attrs:{"return-object":!1,label:"نوع پیمانکار",items:t.contractorTypes,disabled:!t.isEditing,"item-text":"title","item-value":"id"},model:{value:t.item.contractor_type,callback:function(e){t.$set(t.item,"contractor_type",e)},expression:"item.contractor_type"}})],1),i("v-col",{attrs:{cols:"12",md:"2"}},["cmp"==t.item.contractor_type?i("v-autocomplete",{attrs:{"return-object":!0,label:"نوع هزینه ی حمل",items:t.wareTypes,disabled:!t.isEditing,"item-text":"title","item-value":"id"},model:{value:t.item.ware_type,callback:function(e){t.$set(t.item,"ware_type",e)},expression:"item.ware_type"}}):t._e()],1),i("v-col",{attrs:{cols:"12",md:"2"}},[t.item.created_by?i("v-text-field",{attrs:{label:"ثبت کننده",disabled:""},model:{value:t.item.created_by.name,callback:function(e){t.$set(t.item.created_by,"name",e)},expression:"item.created_by.name"}}):t._e()],1),i("v-col",{attrs:{cols:"12",md:"6"}},[i("v-textarea",{attrs:{label:"توضیحات بارگیری",disabled:!t.isEditing},model:{value:t.item.lading_explanation,callback:function(e){t.$set(t.item,"lading_explanation",e)},expression:"item.lading_explanation"}})],1),t.item.driving?[i("v-col",{attrs:{cols:"2"}},[i("money",{attrs:{label:"مبلغ کل",value:t.ladingTotalValue,disabled:""}})],1),i("v-col",{attrs:{cols:"2"}},[i("money",{attrs:{label:"درآمد کمسیون "+("o"==t.item.driving.car.owner?"متفرقه":"شرکت"),value:t.companyCommissionIncome,disabled:""}})],1),i("v-col",{attrs:{cols:"2"}},[i("money",{attrs:{label:"o"==t.item.driving.car.owner?"حساب پرداختنی راننده متفرقه":"درآمد ماشین",value:t.carIncome,disabled:""}})],1)]:t._e(),i("v-col",{attrs:{cols:"12"}},[i("v-divider",{staticStyle:{"border-width":"2px"},attrs:{color:"indigo"}})],1)]],2):t._e(),t.item.type.includes("b")?i("v-row",[i("v-col",{attrs:{cols:"12"}},[i("v-card-title",{staticClass:"py-0"},[t._v("بارنامه دولتی")])],1),i("v-col",{attrs:{cols:"12",md:"2"}},[i("v-autocomplete",{attrs:{"return-object":!0,label:"سری بارنامه",items:t.ladingBillSeriesItems,"item-text":"serial","item-value":"id","no-filter":"","search-input":t.ladingBillSearchInput,disabled:!t.isEditing,clearable:""},on:{"update:searchInput":function(e){t.ladingBillSearchInput=e},"update:search-input":function(e){t.ladingBillSearchInput=e},change:function(e){t.ladingBillSeries&&(t.item.billNumber=t.ladingBillSeries.numbers.filter((function(t){return!t.is_revoked}))[0])}},model:{value:t.ladingBillSeries,callback:function(e){t.ladingBillSeries=e},expression:"ladingBillSeries"}})],1),i("v-col",{attrs:{cols:"12",md:"2"}},[i("v-autocomplete",{attrs:{"return-object":!0,label:"شماره بارنامه",items:t.ladingBillSeries?t.ladingBillSeries.numbers.filter((function(t){return!t.is_revoked})):[],"item-text":"number","item-value":"id",disabled:!t.isEditing},model:{value:t.item.billNumber,callback:function(e){t.$set(t.item,"billNumber",e)},expression:"item.billNumber"}})],1),i("v-col",{attrs:{cols:"12",md:"2"}},[i("date",{attrs:{label:"تاریخ بارنامه",default:!0,disabled:!t.isEditing},model:{value:t.item.bill_date,callback:function(e){t.$set(t.item,"bill_date",e)},expression:"item.bill_date"}})],1),i("v-col",{attrs:{cols:"12",md:"2"}},[i("money",{attrs:{label:"مبلغ بارنامه",disabled:!t.isEditing},model:{value:t.item.bill_price,callback:function(e){t.$set(t.item,"bill_price",e)},expression:"item.bill_price"}})],1),i("v-col",{attrs:{cols:"12",md:"2"}},[i("money",{attrs:{label:"انعام باربری",disabled:!t.isEditing},model:{value:t.item.cargo_tip_price,callback:function(e){t.$set(t.item,"cargo_tip_price",e)},expression:"item.cargo_tip_price"}})],1),i("v-col",{attrs:{cols:"12",md:"2"}},[i("v-autocomplete",{attrs:{"return-object":!0,label:"انجمن",items:t.$store.state.associations,"item-text":"name","item-value":"id",disabled:!t.isEditing},on:{change:function(e){t.item.association_price=t.item.association.price}},model:{value:t.item.association,callback:function(e){t.$set(t.item,"association",e)},expression:"item.association"}})],1),i("v-col",{attrs:{cols:"12",md:"2"}},[i("money",{attrs:{label:"مبلغ انجمن",disabled:!t.isEditing},model:{value:t.item.association_price,callback:function(e){t.$set(t.item,"association_price",e)},expression:"item.association_price"}})],1),i("v-col",{attrs:{cols:"12",md:"2"}},[i("v-autocomplete",{attrs:{"return-object":!1,label:"نحوه دریافت",items:t.receiveTypes,disabled:!t.isEditing},model:{value:t.item.receive_type,callback:function(e){t.$set(t.item,"receive_type",e)},expression:"item.receive_type"}})],1),i("v-col",{attrs:{cols:"12",md:"4"}},[i("money",{attrs:{label:"ارزش افزوده بارنامه دولتی",disabled:!t.isEditing}})],1),i("v-col",{attrs:{cols:"12",md:"2"}},[i("m-file-input",{attrs:{label:"فایل",disabled:!t.isEditing,"delete-attachment":t.item.delete_bill_attachment},on:{"update:deleteAttachment":function(e){return t.$set(t.item,"delete_bill_attachment",e)},"update:delete-attachment":function(e){return t.$set(t.item,"delete_bill_attachment",e)}},model:{value:t.item.bill_attachment,callback:function(e){t.$set(t.item,"bill_attachment",e)},expression:"item.bill_attachment"}})],1),i("v-col",{attrs:{cols:"12",md:"4"}},[i("v-textarea",{attrs:{label:"توضیحات بارنامه",disabled:!t.isEditing},model:{value:t.item.bill_explanation,callback:function(e){t.$set(t.item,"bill_explanation",e)},expression:"item.bill_explanation"}})],1),i("v-col",{attrs:{cols:"6"}},[i("money",{attrs:{label:"مبلغ کل بارنامه",value:t.billTotalPrice,disabled:""}})],1)],1):t._e()]],2)},l=[],n=(i("4160"),i("b64b"),i("159b"),i("4633")),s=i("da4b"),c=i("f51a"),o={props:{id:{default:null}},mixins:[n["a"],s["b"],c["a"]],data:function(){return{baseUrl:"dashtbashi/ladings",leadingSlash:!0,permissionBasename:"lading",formData:!0,hasList:!1,hasIdProp:!0,ladingBillSeries:null,ladingBillSeriesItems:[],ladingBillSearchInput:"",is_destination_amount_dirty:!1,remittanceSearch:"",remittances:[],remittance:null,contractorTypes:[{id:"o",title:"سایر"},{id:"cmp",title:"شرکت"}],wareTypes:[{id:"b",title:"خریداری شده"},{id:"s",title:"فروش رفته"}],types:[{text:"بارگیری",id:"l"},{text:"بارگیری و بارنامه دولتی",id:"lb"},{text:"بارنامه دولتی",id:"b"}]}},computed:{billTotalPrice:function(){var t=+this.item.association_price+ +this.item.bill_price+ +this.item.cargo_tip_price;return this.item.lading_bill_total_value=t||0,t},ladingTotalValue:function(){var t=this.item.destination_amount*this.item.contractor_price;return this.item.lading_total_value=t||0,t},companyCommissionIncome:function(){var t=this.item.destination_amount*(this.item.contractor_price-this.item.fare_price);return this.item.company_commission_income=t||0,t},carIncome:function(){var t=this.item.destination_amount*this.item.fare_price;return this.item.car_income=t||0,t}},watch:{ladingBillSearchInput:function(){this.getLadingBillSeries(this.ladingBillSearchInput)},remittanceSearch:function(){this.getRemittances(this.remittanceSearch)},remittance:function(){var t=this;Object.keys(this.remittance).forEach((function(e){"id"==e?t.item.remittance=t.remittance.id:(t.item[e]=null,t.$set(t.item,e,t.remittance[e]))}))}},methods:{clearForm:function(){this.isEditing=!0,this.item=this.getItemTemplate(),this.changeRouteTo(null),this.remittance=null},getItemTemplate:function(){return{type:"",remittance:{},association:{id:null,price:null},association_price:0,cargo_tip_price:0,contractor_type:this.contractorTypes[0],lading_ware:null,lading_contractor_price:null,lading_contractor:null,lading_bill_total_value:0}},getData:function(){this.getDrivings(),this.getAssociations(),this.id&&this.getItem(this.id)},getLadingBillSeries:function(t){var e=this;this.request({loading:!1,url:this.endpoint("dashtbashi/ladingBillSeries/?limit=10&offset=0"),method:"get",params:{serial__icontains:t},success:function(t){e.ladingBillSeriesItems=t["results"]}})},setItem:function(t){this.item=t,this.remittance=t.remittance,this.ladingBillSeries=t.billNumber?t.billNumber.series:null,this.hasList||this.id==t.id||this.changeRouteTo(t.id)},getItemByPosition:function(t){var e=this;this.request({url:this.endpoint("dashtbashi/ladings/byPosition"),method:"get",params:{id:this.id,position:t},success:function(t){e.setItem(t)},error:function(t){404==t.response.status&&e.notify("بارگیری وجود ندارد","warning")}})}}},r=o,m=i("2877"),d=i("6544"),u=i.n(d),b=i("c6a6"),p=i("99d9"),v=i("62ad"),h=i("ce7e"),_=i("0fd9"),g=i("8654"),f=i("a844"),x=Object(m["a"])(r,a,l,!1,null,"4c732d2c",null);e["default"]=x.exports;u()(x,{VAutocomplete:b["a"],VCardTitle:p["c"],VCol:v["a"],VDivider:h["a"],VRow:_["a"],VTextField:g["a"],VTextarea:f["a"]})},4633:function(t,e,i){"use strict";var a=i("ae79");e["a"]={components:{OpenSanadBtn:a["a"]},data:function(){return{editable:!1}},created:function(){this.setEditable()},watch:{id:function(){this.setEditable()}},methods:{setEditable:function(){this.id?this.editable=!1:this.editable=!0},makeFormEditable:function(){this.editable=!0},makeFormUneditable:function(){this.editable=!1}}}},f51a:function(t,e,i){"use strict";i("d81d");e["a"]={data:function(){return{months:[{text:"فروردین",value:1},{text:"اردیبهشت",value:2},{text:"خرداد",value:3},{text:"تیر",value:4},{text:"مرداد",value:5},{text:"شهریور",value:6},{text:"مهر",value:7},{text:"آبان",value:8},{text:"آذر",value:9},{text:"دی",value:10},{text:"بهمن",value:11},{text:"اسفند",value:12}],tipPayers:[{title:"شرکت",id:"cmp"},{title:"پیمانکار",id:"cnt"}],remittancePaymentMethods:[{text:"کمیسیون و کرایه به شرکت",value:"tc"},{text:"کمیسیون به شرکت و کرایه به راننده",value:"tcd"},{text:"کمیسیون و کرایه با شرکت",value:"cp"}],receiveTypes:[{text:"نسیه",value:"cr"},{text:"نقدی",value:"cs"},{text:"کارت خوان",value:"p"}]}},methods:{getDrivers:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t||!this.$store.state.drivers.length)return this.request({url:this.endpoint("dashtbashi/drivers/"),method:"get",success:function(t){e.$store.commit("setDrivers",t),i&&i(t)}})},getCars:function(t){var e=this;if(t||!this.$store.state.cars.length)return this.request({url:this.endpoint("dashtbashi/cars/"),method:"get",success:function(t){e.$store.commit("setCars",t)}})},getDrivings:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t||!this.$store.state.drivings.length)return this.request({url:this.endpoint("dashtbashi/drivings/"),method:"get",success:function(t){e.$store.commit("setDrivings",t),i&&i(t)}});i&&i(this.$store.state.drivings)},getAssociations:function(t){var e=this;if(t||!this.$store.state.associations.length)return this.request({url:this.endpoint("dashtbashi/associations/"),method:"get",success:function(t){e.$store.commit("setAssociations",t)}})},getRemittances:function(t){var e=this;this.request({url:this.endpoint("dashtbashi/remittances/?limit=10&offset=0"),method:"get",params:{code__icontains:t},success:function(t){e.remittances=t["results"].map((function(t){return t.code=String(t.code),t}))}})}}}}}]);
//# sourceMappingURL=chunk-4660eb5a.49bce104.js.map