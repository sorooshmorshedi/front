(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-46616d0a"],{4633:function(t,e,i){"use strict";var s=i("ae79");e["a"]={components:{OpenSanadBtn:s["a"]},data:function(){return{editable:!1}},created:function(){this.setEditable()},watch:{id:function(){this.setEditable()}},methods:{setEditable:function(){this.id?this.editable=!1:this.editable=!0},makeFormEditable:function(){this.editable=!0},makeFormUneditable:function(){this.editable=!1}}}},"48f3":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("m-form",{attrs:{title:"بارگیری شرکت نفت",isEditing:t.isEditing,showList:!1,canDelete:t.canDelete,canSubmit:t.canSubmit,confirmBtnText:t.confirmBtnText,cancelConfirmBtnText:t.cancelConfirmBtnText,canConfirm:t.canConfirm,canCancelConfirm:t.canCancelConfirm},on:{"update:isEditing":function(e){t.isEditing=e},"update:is-editing":function(e){t.isEditing=e},cancelConfirm:t.cancelConfirm,confirm:t.confirm,goToForm:t.getItemByPosition,submit:t.submit,delete:t.deleteItem,clearForm:function(e){return t.clearForm()}},scopedSlots:t._u([{key:"header-btns",fn:function(){return[t.item.sanad?i("open-sanad-btn",{attrs:{sanad:t.item.sanad}}):t._e()]},proxy:!0}])},[[i("v-row",[i("v-col",{attrs:{cols:"12",md:"2"}},[i("v-text-field",{attrs:{label:"عطف",disabled:""},model:{value:t.item.id,callback:function(e){t.$set(t.item,"id",e)},expression:"item.id"}})],1),i("v-col",{attrs:{cols:"12",md:"2"}},[i("v-autocomplete",{attrs:{label:"ماه",items:t.months,"return-object":!1},model:{value:t.item.month,callback:function(e){t.$set(t.item,"month",e)},expression:"item.month"}})],1),i("v-col",{attrs:{cols:"12",md:"2"}},[i("date",{attrs:{label:"تاریخ سیاهه",default:!0,disabled:!t.isEditing},model:{value:t.item.date,callback:function(e){t.$set(t.item,"date",e)},expression:"item.date"}})],1),i("v-col",{attrs:{cols:"12",md:"2"}},[i("date",{attrs:{label:"خروجی",default:!0,disabled:!t.isEditing},model:{value:t.item.export_date,callback:function(e){t.$set(t.item,"export_date",e)},expression:"item.export_date"}})],1),i("v-col",{attrs:{cols:"12",md:"4"}},[i("v-autocomplete",{attrs:{"return-object":!0,label:"حمل کننده",items:t.$store.state.drivings,"item-text":"title","item-value":"id"},model:{value:t.item.driving,callback:function(e){t.$set(t.item,"driving",e)},expression:"item.driving"}})],1),i("v-col",{attrs:{cols:"12",md:"8"}},[i("v-textarea",{attrs:{label:"توضیحات",disabled:!t.isEditing},model:{value:t.item.explanation,callback:function(e){t.$set(t.item,"explanation",e)},expression:"item.explanation"}})],1),i("v-col",{attrs:{cols:"12",md:"4"}},[t.item.created_by?i("v-text-field",{attrs:{label:"ثبت کننده",disabled:""},model:{value:t.item.created_by.name,callback:function(e){t.$set(t.item.created_by,"name",e)},expression:"item.created_by.name"}}):t._e()],1),i("v-col",{attrs:{cols:"12"}},[i("v-simple-table",{staticClass:"form-items"},[i("thead",[i("tr",[i("th",[t._v("#")]),i("th",[t._v("تاریخ بارگیری")]),i("th",[t._v("مبدا")]),i("th",[t._v("مقصد")]),i("th",[t._v("وزن")]),i("th",[t._v("مبلغ ناخالص")]),i("th",[t._v("حق بیمه تامین اجتماعی")]),i("th",[t._v("درصد مالیات بر ارزش افزوده")]),i("th",[t._v("مبلغ مالیات بر ارزش افزوده")]),i("th",[t._v("درصد عوارض بر ارزش افزوده")]),i("th",[t._v("مبلغ عوارض بر ارزش افزوده")]),i("th",[t._v("مبلغ کل با ارزش افزوده")]),i("th",[t._v("مبلغ خالص")]),i("th",[t._v("کمیسیون شرکت")]),i("th",[t._v("درآمد ماشین")]),i("th")])]),i("tbody",[t._l(t.rows,(function(e,s){return i("tr",{key:s,class:{"d-print-none":s==t.rows.length-1}},[i("td",{staticClass:"tr-counter"},[t._v(t._s(s+1))]),i("td",[i("date",{attrs:{default:!0,disabled:!t.isEditing},model:{value:e.date,callback:function(i){t.$set(e,"date",i)},expression:"row.date"}})],1),i("td",[i("city-select",{attrs:{disabled:!t.isEditing},model:{value:e.origin,callback:function(i){t.$set(e,"origin",i)},expression:"row.origin"}})],1),i("td",[i("city-select",{attrs:{disabled:!t.isEditing},model:{value:e.destination,callback:function(i){t.$set(e,"destination",i)},expression:"row.destination"}})],1),i("td",[i("money",{attrs:{disabled:!t.isEditing},model:{value:e.weight,callback:function(i){t.$set(e,"weight",i)},expression:"row.weight"}})],1),i("td",[i("money",{attrs:{disabled:!t.isEditing},model:{value:e.gross_price,callback:function(i){t.$set(e,"gross_price",i)},expression:"row.gross_price"}})],1),i("td",[i("money",{attrs:{disabled:!t.isEditing},model:{value:e.insurance_price,callback:function(i){t.$set(e,"insurance_price",i)},expression:"row.insurance_price"}})],1),i("td",[i("v-text-field",{attrs:{type:"number",disabled:!t.isEditing},model:{value:e.tax_percent,callback:function(i){t.$set(e,"tax_percent",i)},expression:"row.tax_percent"}})],1),i("td",[i("money",{attrs:{value:t.taxPrice(e),disabled:""}})],1),i("td",[i("v-text-field",{attrs:{type:"number",disabled:!t.isEditing},model:{value:e.complication_percent,callback:function(i){t.$set(e,"complication_percent",i)},expression:"row.complication_percent"}})],1),i("td",[i("money",{attrs:{value:t.complicationPrice(e),disabled:""}})],1),i("td",[i("money",{attrs:{value:t.rowSum(e),disabled:!0}})],1),i("td",[i("money",{attrs:{value:t.netPrice(e),disabled:!0}})],1),i("td",[i("money",{attrs:{value:t.companyCommission(e),disabled:!0}})],1),i("td",[i("money",{attrs:{value:t.carIncome(e),disabled:!0}})],1),i("td",{staticClass:"d-print-none"},[s!=t.rows.length-1?i("v-btn",{staticClass:"red--text",attrs:{icon:"",disabled:!t.isEditing},on:{click:function(e){return t.deleteRow(s)}}},[i("v-icon",[t._v("delete")])],1):t._e()],1)])})),i("tr",{staticClass:"grey lighten-3 text-white"},[i("td",{staticClass:"text-right",attrs:{colspan:"4"}},[t._v("مجموع:")]),i("td",[t._v(t._s(t._f("toMoney")(t.rowsSum("weight"))))]),i("td",[t._v(t._s(t._f("toMoney")(t.rowsSum("gross_price"))))]),i("td",[t._v(t._s(t._f("toMoney")(t.rowsSum("insurance_price"))))]),i("td"),i("td",[t._v(t._s(t._f("toMoney")(t.rowsTaxPrice)))]),i("td"),i("td",[t._v(t._s(t._f("toMoney")(t.rowsComplicationPrice)))]),i("td",[t._v(t._s(t._f("toMoney")(t.rowsSum("sum"))))]),i("td",[t._v(t._s(t._f("toMoney")(t.rowsSum("net_price"))))]),i("td",[t._v(t._s(t._f("toMoney")(t.rowsSum("company_commission"))))]),i("td",[t._v(t._s(t._f("toMoney")(t.rowsSum("car_income"))))]),i("td",{staticClass:"d-print-none"},[i("v-btn",{staticClass:"red--text",attrs:{icon:"",disabled:!t.isEditing},on:{click:function(e){return t.deleteRow(-1)}}},[i("v-icon",[t._v("delete_sweep")])],1)],1)])],2)])],1)],1)]],2)},n=[],a=(i("4160"),i("a434"),i("159b"),i("5530")),o=i("b85c"),r=i("4633"),c=i("3c1f"),l=i("0359"),d=i("f51a"),m=i("da4b"),u={name:"Form",components:{money:c["a"],date:l["a"]},mixins:[r["a"],d["a"],m["b"]],props:["id"],data:function(){return{hasList:!1,hasIdProp:!0,baseUrl:"dashtbashi/oilCompanyLadings",leadingSlash:!0,permissionBasename:"oilCompanyLading"}},computed:{rowsTaxPrice:function(){var t,e=0,i=Object(o["a"])(this.rows);try{for(i.s();!(t=i.n()).done;){var s=t.value;e+=this.taxPrice(s)}}catch(n){i.e(n)}finally{i.f()}return e},rowsComplicationPrice:function(){var t,e=0,i=Object(o["a"])(this.rows);try{for(i.s();!(t=i.n()).done;){var s=t.value;e+=this.complicationPrice(s)}}catch(n){i.e(n)}finally{i.f()}return e}},watch:{rows:{handler:function(){var t=this.rows[this.rows.length-1];t&&t.gross_price&&this.rows.push(this.getRowTemplate())},deep:!0}},methods:{getItemTemplate:function(){return{}},getData:function(){this.getDrivings()},getRowTemplate:function(){return{sum:0,net_price:0,gross_price:0,insurance_price:0,tax_percent:this.getOptionValue("taxPercent"),company_commission_percent:+this.getOptionValue("companyCommissionFromOilCompanyLading"),complication_percent:this.getOptionValue("addedValuePercentOfOilCompanyLading")}},taxPrice:function(t){return t.tax_value=+t.tax_percent*+t.gross_price/100||0,t.tax_value},complicationPrice:function(t){return t.complication_price=+t.complication_percent*+t.gross_price/100||0,t.complication_price},rowSum:function(t){var e=(+t.gross_price||0)+this.taxPrice(t)+this.complicationPrice(t)-(+t.insurance_price||0);return t.total_value=e,e},netPrice:function(t){var e=+t.gross_price-+t.insurance_price;return t.net_price=e,e},companyCommission:function(t){var e=this.netPrice(t)*+t.company_commission_percent/100||0;return t.company_commission=e,e},carIncome:function(t){var e=this.netPrice(t)-this.companyCommission(t)||0;return t.car_income=e,e},rowsSum:function(t){var e,i=0,s=Object(o["a"])(this.rows);try{for(s.s();!(e=s.n()).done;){var n=e.value,a=n[t];this.hasValue(a)&&(i+=+a)}}catch(r){s.e(r)}finally{s.f()}return i},getItemByPosition:function(t){var e=this;return this.request({url:this.endpoint("dashtbashi/oilCompanyLadings/byPosition"),method:"get",params:{id:this.id,position:t},success:function(t){e.setItem(t)}})},setItem:function(t){var e=this;this.item=t,this.itemsToDelete=[],this.rows=[],t.items.forEach((function(t){var i=Object(a["a"])({},t);e.rows.push(i)})),this.rows.push(this.getRowTemplate()),this.changeRouteTo(t.id)},deleteRow:function(t){var e=this;if(-1==t)this.rows.forEach((function(t){t.id&&e.itemsToDelete.push(t.id)})),this.rows.splice(0,this.rows.length-1);else{var i=this.rows[t];i.id&&this.itemsToDelete.push(i.id),this.rows.splice(t,1)}},getSerialized:function(){var t=this,e={form:this.extractIds(this.item),items:{ids_to_delete:this.itemsToDelete,items:[]}};return this.rows.forEach((function(i,s){if(s!=t.rows.length-1){var n=t.copy(i);n=t.extractIds(n),n.bed=+n.bed,n.bes=+n.bes,e.items.items.push(n)}})),e.form.car_income=this.rowsSum("car_income"),e.form.company_commission=this.rowsSum("company_commission"),e.form.total_value=this.rowsSum("total_value"),e.form.gross_price=this.rowsSum("gross_price"),e.form.insurance_price=this.rowsTaxPrice,e.form.tax_price=this.rowsTaxPrice,e.form.complication_price=this.rowsComplicationPrice,e.form.weight=this.rowsSum("weight"),e}}},h=u,p=i("2877"),v=i("6544"),f=i.n(v),_=i("c6a6"),b=i("8336"),g=i("62ad"),x=i("132d"),w=i("0fd9"),y=i("1f4f"),C=i("8654"),P=i("a844"),E=Object(p["a"])(h,s,n,!1,null,"5b452874",null);e["default"]=E.exports;f()(E,{VAutocomplete:_["a"],VBtn:b["a"],VCol:g["a"],VIcon:x["a"],VRow:w["a"],VSimpleTable:y["a"],VTextField:C["a"],VTextarea:P["a"]})},f51a:function(t,e,i){"use strict";i("d81d");e["a"]={data:function(){return{months:[{text:"فروردین",value:1},{text:"اردیبهشت",value:2},{text:"خرداد",value:3},{text:"تیر",value:4},{text:"مرداد",value:5},{text:"شهریور",value:6},{text:"مهر",value:7},{text:"آبان",value:8},{text:"آذر",value:9},{text:"دی",value:10},{text:"بهمن",value:11},{text:"اسفند",value:12}],tipPayers:[{title:"شرکت",id:"cmp"},{title:"پیمانکار",id:"cnt"}],remittancePaymentMethods:[{text:"کمیسیون و کرایه به شرکت",value:"tc"},{text:"کمیسیون به شرکت و کرایه به راننده",value:"tcd"},{text:"کمیسیون و کرایه با شرکت",value:"cp"}],receiveTypes:[{text:"نسیه",value:"cr"},{text:"نقدی",value:"cs"},{text:"کارت خوان",value:"p"}]}},methods:{getDrivers:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t||!this.$store.state.drivers.length)return this.request({url:this.endpoint("dashtbashi/drivers/"),method:"get",success:function(t){e.$store.commit("setDrivers",t),i&&i(t)}})},getCars:function(t){var e=this;if(t||!this.$store.state.cars.length)return this.request({url:this.endpoint("dashtbashi/cars/"),method:"get",success:function(t){e.$store.commit("setCars",t)}})},getDrivings:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t||!this.$store.state.drivings.length)return this.request({url:this.endpoint("dashtbashi/drivings/"),method:"get",success:function(t){e.$store.commit("setDrivings",t),i&&i(t)}});i&&i(this.$store.state.drivings)},getAssociations:function(t){var e=this;if(t||!this.$store.state.associations.length)return this.request({url:this.endpoint("dashtbashi/associations/"),method:"get",success:function(t){e.$store.commit("setAssociations",t)}})},getRemittances:function(t){var e=this;this.request({url:this.endpoint("dashtbashi/remittances/?limit=10&offset=0"),method:"get",params:{code__icontains:t},success:function(t){e.remittances=t["results"].map((function(t){return t.code=String(t.code),t}))}})}}}}}]);
//# sourceMappingURL=chunk-46616d0a.26a66648.js.map