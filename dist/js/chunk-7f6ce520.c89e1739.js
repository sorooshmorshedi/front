(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7f6ce520","chunk-7290aaf0","chunk-2d0c5179"],{3915:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("m-form",{attrs:{title:t.title,showList:!1,listRoute:{name:"List",params:{form:"transaction",type:t.transactionType}},exportParams:{id:this.id},showNavigationButtons:!t.modalMode,showSubmitAndClearForm:!t.modalMode,canDelete:t.canDelete,canSubmit:t.canSubmit,isEditing:t.isEditing,confirmBtnText:t.confirmBtnText,cancelConfirmBtnText:t.cancelConfirmBtnText,canConfirm:t.canConfirm,canCancelConfirm:t.canCancelConfirm},on:{"update:isEditing":function(e){t.isEditing=e},"update:is-editing":function(e){t.isEditing=e},cancelConfirm:t.cancelConfirm,confirm:t.confirm,clearForm:t.clearForm,goToForm:t.getItemByPosition,submit:t.validate,delete:t.deleteItem},scopedSlots:t._u([{key:"header-btns",fn:function(){return[t.item.sanad?a("open-sanad-btn",{attrs:{sanad:t.item.sanad}}):t._e(),t.isImprest&&void 0!=t.id?a("v-btn",{staticClass:"blue white--text mr-1",attrs:{to:{name:"ImprestSettlement",params:{id:t.imprestSettlementId},query:{"item.account":t.item.account.id,imprest:t.item.id}}}},[t._v("تسویه تنخواه")]):t._e(),t.isImprest?t._e():a("v-btn",{staticClass:"teal white--text mr-1",on:{click:function(e){t.factorsDialog=!0}}},[t._v("پرداخت شده برای فاکتور های")])]},proxy:!0}])},[[t.modalMode?t._e():a("v-row",[a("v-col",{attrs:{cols:"12",md:"2"}},[a("v-text-field",{attrs:{label:"شماره",disabled:""},model:{value:t.item.code,callback:function(e){t.$set(t.item,"code",e)},expression:"item.code"}})],1),a("v-col",{attrs:{cols:"12",md:"2"}},[a("date",{attrs:{label:" * تاریخ",default:!0,disabled:!t.isEditing},model:{value:t.item.date,callback:function(e){t.$set(t.item,"date",e)},expression:"item.date"}})],1),a("v-col",{attrs:{cols:"12",md:"2"}},["payment"==t.transactionType?a("date",{attrs:{placeholder:"تاریخ راس",disabled:""}}):t._e()],1),a("v-col",{attrs:{cols:"12",md:"6"}},[a("account-select",{attrs:{label:t.accountLabel,itemsType:t.accountsType,disabled:t.modalMode||!t.isEditing,required:"",floatAccount:t.item.floatAccount,costCenter:t.item.costCenter},on:{"update:floatAccount":function(e){return t.item.floatAccount=e},"update:costCenter":function(e){return t.item.costCenter=e}},model:{value:t.item.account,callback:function(e){t.$set(t.item,"account",e)},expression:"item.account"}})],1),a("v-col",{attrs:{cols:"12",md:"8"}},[a("v-textarea",{attrs:{label:"توضیحات",disabled:!t.isEditing},model:{value:t.item.explanation,callback:function(e){t.$set(t.item,"explanation",e)},expression:"item.explanation"}})],1),a("v-col",{attrs:{cols:"12",md:"4"}},[t.item.created_by?a("v-text-field",{attrs:{label:"ثبت کننده",disabled:""},model:{value:t.item.created_by.name,callback:function(e){t.$set(t.item.created_by,"name",e)},expression:"item.created_by.name"}}):t._e()],1)],1),a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("v-simple-table",[a("thead",[a("tr",[a("th",{staticClass:"tr-counter"},[t._v("#")]),a("th",[t._v("* نوع "+t._s(t.title))]),a("th",[t._v("* نام حساب")]),a("th",[t._v("* مبلغ")]),a("th",[t._v("شماره مستند")]),a("th",[t._v("* تاریخ "+t._s(t.title))]),a("th",[t._v("سررسید")]),a("th",[t._v("نام بانک")]),a("th",[t._v("توضیحات")])])]),a("tbody",[t._l(t.rows,(function(e,i){return a("tr",{key:i,class:{"d-print-none":i==t.rows.length-1}},[a("td",[t._v(t._s(i+1))]),a("td",{staticStyle:{"min-width":"150px"}},[a("v-autocomplete",{attrs:{"return-object":!0,disabled:!t.isEditing||t.hasCheque(e),items:t.itemPaymentMethods,"item-text":"name","item-value":"id"},model:{value:t.rows[i].type,callback:function(e){t.$set(t.rows[i],"type",e)},expression:"rows[i].type"}}),t.isChequeType(e)&&!t.hasCheque(e)?a("v-btn",{staticClass:"blue white--text mt-1",attrs:{block:"",disabled:!t.isEditing},on:{click:function(a){return t.openSubmitChequeDialog(e,i)}}},[t._v("ثبت چک")]):t._e()],1),a("td",{staticClass:"tr-account"},[t.rows[i].type?a("account-select",{attrs:{horizontal:!0,"items-type":"level3",disabled:!t.isEditing,"account-disabled":!0,floatAccount:t.rows[i].floatAccount,costCenter:t.rows[i].costCenter},on:{"update:floatAccount":function(e){return t.rows[i].floatAccount=e},"update:costCenter":function(e){return t.rows[i].costCenter=e}},model:{value:t.rows[i].type.account,callback:function(e){t.$set(t.rows[i].type,"account",e)},expression:"rows[i].type.account"}}):t._e()],1),a("td",[a("money",{staticClass:"form-control",attrs:{disabled:!t.isEditing||t.isChequeType(e)},model:{value:t.rows[i].value,callback:function(e){t.$set(t.rows[i],"value",e)},expression:"rows[i].value"}})],1),a("td",{staticStyle:{width:"50px"}},[a("v-text-field",{staticClass:"form-control",attrs:{disabled:!t.isEditing||t.isChequeType(e),type:"text"},model:{value:t.rows[i].documentNumber,callback:function(e){t.$set(t.rows[i],"documentNumber",e)},expression:"rows[i].documentNumber"}})],1),a("td",[a("date",{staticClass:"form-control",attrs:{disabled:!t.isEditing||t.isChequeType(e),default:"1"},model:{value:t.rows[i].date,callback:function(e){t.$set(t.rows[i],"date",e)},expression:"rows[i].date"}})],1),a("td",[a("date",{staticClass:"form-control",attrs:{disabled:""},model:{value:t.rows[i].due,callback:function(e){t.$set(t.rows[i],"due",e)},expression:"rows[i].due"}})],1),a("td",[a("v-text-field",{staticClass:"form-control form-control",attrs:{disabled:!t.isEditing||!t.hasBank(e),type:"text"},model:{value:t.rows[i].bankName,callback:function(e){t.$set(t.rows[i],"bankName",e)},expression:"rows[i].bankName"}})],1),a("td",[a("v-text-field",{staticClass:"form-control form-control",attrs:{disabled:!t.isEditing||t.isChequeType(e),type:"text"},model:{value:t.rows[i].explanation,callback:function(e){t.$set(t.rows[i],"explanation",e)},expression:"rows[i].explanation"}})],1),a("td",{staticClass:"d-print-none"},[i==t.rows.length-1||t.hasCheque(e)?t._e():a("v-btn",{staticClass:"red--text",attrs:{disabled:!t.isEditing,icon:""},on:{click:function(e){return t.deleteRow(i)}}},[a("v-icon",[t._v("delete")])],1),t.hasCheque(e)&&e.cheque.id?a("router-link",{staticClass:"btn btn-sm btn-info",attrs:{to:{name:"ChequeDetail",params:{id:e.cheque.id}},target:"_blank"}},[t._v("مشاهده جزئیات چک")]):t._e()],1)])})),a("tr"),a("tr",{staticClass:"grey lighten-3 text-white"},[a("td",{attrs:{colspan:"2"}}),a("td",{staticClass:"text-left"},[t._v("مجموع:")]),a("td",{},[t._v(t._s(t._f("toMoney")(t.rowsSum("value"))))]),a("td",{attrs:{colspan:"5"}}),a("td",{staticClass:"d-print-none"},[a("v-btn",{staticClass:"red--text",attrs:{icon:"",disabled:!t.isEditing},on:{click:function(e){return t.deleteRow(-1)}}},[a("v-icon",[t._v("delete_sweep")])],1)],1)])],2)])],1)],1)]],2),a("v-dialog",{attrs:{scrollable:"","max-width":"1200px"},model:{value:t.factorsDialog,callback:function(e){t.factorsDialog=e},expression:"factorsDialog"}},[a("v-card",[a("v-card-title",[t._v("فاکتور های پرداخت نشده")]),a("v-card-text",[a("v-simple-table",[a("thead",[a("tr",[a("th",[t._v("شماره فاکتور")]),a("th",[t._v("نوع فاکتور")]),a("th",[t._v("توضیحات")]),a("th",[t._v("تاریخ")]),a("th",[t._v("جمع فاکتور")]),a("th",[t._v("پرداختی قبلی")]),t.isEditing?t._e():a("th",[t._v("پرداختی فعلی")]),a("th",[t._v("مانده")]),t.isEditing?a("th",[t._v("پرداختی فعلی")]):t._e(),a("th")])]),a("tbody",t._l(t.factors,(function(e,i){return a("tr",{key:i},[a("td",[t._v(t._s(e.code))]),a("td",[t._v(t._s(t.factorTypes[e.type]))]),a("td",[t._v(t._s(e.explanation))]),a("td",[t._v(t._s(e.date))]),a("td",[t._v(t._s(t._f("toMoney")(e.sum)))]),a("td",[t._v(t._s(t._f("toMoney")(e.prevPaidValue)))]),t.isEditing?t._e():a("td",[t._v(t._s(t._f("toMoney")(e.payment.value)))]),a("td",[t._v(t._s(t._f("toMoney")(e.remain)))]),t.isEditing?a("td",[a("money",{attrs:{disabled:!t.isEditing},on:{input:function(a){return t.validatePaidValue(e)}},model:{value:e.payment.value,callback:function(a){t.$set(e.payment,"value",a)},expression:"f.payment.value"}})],1):t._e(),a("td",[a("v-btn",{staticClass:"blue white--text",on:{click:function(a){return t.openFactor(e)}}},[t._v(" مشاهده فاکتور "),a("v-chip",{staticClass:"app-background-color mr-2",attrs:{"x-small":""}},[t._v(t._s(e.code))])],1)],1)])})),0)])],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticClass:"blue white--text",attrs:{disabled:!t.isEditing},on:{click:function(e){return t.splitValue(!0)}}},[t._v("سرشکن کردن از پایین")]),a("v-btn",{staticClass:"blue white--text",attrs:{disabled:!t.isEditing},on:{click:function(e){return t.splitValue()}}},[t._v("سرشکن کردن از بالا")]),a("v-btn",{staticClass:"green white--text w-100px",attrs:{disabled:!t.isEditing||!t.isPaymentsValid},on:{click:function(e){t.factorsDialog=!1}}},[t._v("تایید")])],1)],1)],1),a("v-dialog",{attrs:{scrollable:"","max-width":"1200px"},model:{value:t.submitChequeDialog,callback:function(e){t.submitChequeDialog=e},expression:"submitChequeDialog"}},[a("v-card",[a("v-card-text",[a("cheque-form",{ref:"chequeForm",attrs:{receivedOrPaid:t.transactionType[0],modalMode:!0,account:t.item.account,floatAccount:t.item.floatAccount,costCenter:t.item.costCenter},on:{submit:t.addCheque}})],1)],1)],1)],1)},s=[],n=(a("4de4"),a("4160"),a("caad"),a("2532"),a("159b"),a("b85c")),o=a("a49f"),l=a("da4b"),r=a("3c1f"),c=a("0359"),u=a("2ef0"),d=a.n(u),m=a("8a10"),h={name:"TransactionForm",components:{ChequeForm:m["default"],money:r["a"],date:c["a"]},mixins:[l["b"],o["a"]],props:{transactionType:{required:!0},id:{},accountId:{},factorId:{},modalMode:{default:!1}},data:function(){return{baseUrl:"transactions",leadingSlash:!0,hasList:!1,hasIdProp:!0,rowKey:"type",factorsDialog:!1,submitChequeDialog:!1,item:{},rows:[],itemsToDelete:[],chequeRowIndex:null,factors:[],factorTypes:{buy:"خرید",sale:"فروش",backFromBuy:"برگشت از خرید",backFromSale:"برگشت از فروش"},d:{getNotPaidFactors:null}}},created:function(){this.d.getNotPaidFactors=d.a.debounce(this.getNotPaidFactors,1e3,{}),this.getDefaultAccounts()},computed:{accountsType:function(){return this.isImprest?"imprests":"level3"},imprestSettlementId:function(){return this.item.imprestSettlements.length?this.item.imprestSettlements[0]:null},title:function(){return"receive"==this.transactionType?"دریافت":"payment"==this.transactionType?"پرداخت":this.isImprest?"پرداخت تنخواه":void 0},permissionBasename:function(){return"".concat(this.transactionType,"Transaction")},isImprest:function(){return"imprest"==this.transactionType},accountLabel:function(){return this.isImprest?"* تنخواه گردان":" * کد - نام مشتری"},itemPaymentMethods:function(){var t="receive"==this.transactionType?"receive":"payment";return this.defaultAccounts.filter((function(e){return e.usage&&e.usage.toLowerCase().includes(t)}))},itemAccounts:function(){return this.accountsSelectValues.levels[3]},isPaymentsValid:function(){var t,e=0,a=Object(n["a"])(this.factors);try{for(a.s();!(t=a.n()).done;){var i=t.value;e+=+i.payment.value}}catch(s){a.e(s)}finally{a.f()}return e<=this.sum}},watch:{"item.account":function(){this.item.account&&this.d.getNotPaidFactors()}},methods:{validatePaidValue:function(t){var e=this,a=+t.payment.value;if(a<0)t.payment.value=0;else if(a>0){var i=+t.remain,s=0;t.payments.forEach((function(t){t.item==e.item.id&&(s+=+t.value)})),a-s>i&&this.$nextTick((function(){return t.payment.value=i+s}))}},getItemByPosition:function(t){var e=this;return this.request({url:this.endpoint("".concat(this.baseUrl,"/byPosition")),method:"get",params:{id:this.item.id,position:t,type:this.transactionType},success:function(t){e.setItem(t)}})},setAccount:function(t){var e=this.itemAccounts.filter((function(e){return e.id==t}))[0];this.item.account=e},selectNotPaidFactor:function(t){var e=this.factors.filter((function(e){return e.id==t}));if(e.length){e=e[0],this.item.floatAccount=e.floatAccount,this.item.costCenter=e.costCenter;var a=e.sum-e.paidValue;this.rows[0].value=a,this.rows.push(this.getRowTemplate()),e.payment.value=a}else console.error("Factor Not Found")},getNotPaidFactors:function(){var t=this;return this.item.account&&this.item.account.id&&this.id&&(this.item.id=this.id),this.request({url:this.endpoint("factors/notPaidFactors"),method:"get",params:{transactionType:this.transactionType,itemId:this.item.id,accountId:this.item.account.id},success:function(e){t.factors=[];var a,i=Object(n["a"])(e);try{for(i.s();!(a=i.n()).done;){var s=a.value;s.prevPaidValue=s.paidValue,s.remain=+s.sum-+s.paidValue;var o=[];t.item.id&&(o=s.payments.filter((function(e){return e.item==t.item.id}))),o.length?(o=o[0],s.payment=t.copy(o),s.prevPaidValue-=o.value):s.payment={value:0,factor:s.id},t.factors.push(s)}}catch(l){i.e(l)}finally{i.f()}t.factorId&&t.selectNotPaidFactor(t.factorId)}})},validate:function(t){var e=this,a=!0;1==this.rows.length&&(this.notify("لطفا حداقل یک ردیف وارد کنید","danger"),a=!1),this.rows.forEach((function(t,i){i!=e.rows.length-1&&(e.hasValue(t.value)||(e.notify("لطفا مبلغ ردیف ".concat(i+1," را وارد کنید"),"danger"),a=!1),e.hasValue(t.date)&&10==t.date.length||(e.notify("لطفا تاریخ ردیف ".concat(i+1," را به صورت صحیح وارد کنید"),"danger"),a=!1))}));var i=0;this.factors.forEach((function(t){i+=+t.payment.value})),0!=i&&i>this.sum&&(this.notify("مبلغ وارد شده برای فاکتور های پرداختی باید کمتر و یا مساوری مجموع ردیف ها باشد","danger"),a=!1),a&&(this.modalMode?this.$emit("submit",this.getSerialized()):this.submit(t))},getSerialized:function(){var t=this,e={};return e.item=this.extractIds(this.item),e.item.type=this.transactionType,e.items={items:[],ids_to_delete:this.itemsToDelete},this.rows.forEach((function(a,i){if(i==t.rows.length-1)return a;var s=t.copy(a);s.id||(s.account=s.type.account),s.cheque&&(s.cheque=t.extractIds(s.cheque)),e.items.items.push(t.extractIds(s,"cheque"))})),e.payments={items:[],ids_to_delete:[]},this.factors.forEach((function(t){var a=t.payment;e.payments.items.push(a)})),e},hasBank:function(t){return!this.isChequeType(t)&&(!t.type||"cash"!=t.type.codename)},isChequeType:function(t){return t.type&&t.type.codename&&t.type.codename.includes("Cheque")},hasCheque:function(t){return t.cheque},openSubmitChequeDialog:function(t,e){var a=this,i=this.item.account;i?!i.floatAccountGroup||this.item.floatAccount?!i.costCenterGroup||this.item.costCenter?(this.chequeRowIndex=e,this.submitChequeDialog=!0,this.$nextTick((function(){a.$refs.chequeForm.setDefaults({"item.account":a.item.account.id})}))):this.notify("لطفا مرکز هزینه و درآمد را انتخاب کنید","danger"):this.notify("لطفا حساب شناور را انتخاب کنید","danger"):this.notify("ابتدا حساب را انتخاب کنید","danger")},addCheque:function(t){if(this.hasValue(t.serial))if(this.hasValue(t.value))if(10==t.date.length&&10==t.due.length){var e=this.rows[this.chequeRowIndex];e.cheque=t,e.value=t.value,e.documentNumber=t.serial,e.date=t.date,e.due=t.due,e.bankName=t.bankName,e.value=t.value,e.explanation=t.explanation,this.submitChequeDialog=!1}else this.notify("لطفا تاریخ های چک را به صورت صحیح وارد کنید","danger");else this.notify("لطفا مبلغ چک را وارد کنید","danger");else this.notify("لطفا سریال چک را وارد کنید","danger")},clearForm:function(){this.log("Clear Item"),this.changeRouteTo(null),this.rows=[this.getRowTemplate()],this.item=this.getItemTemplate(),this.factors=[],this.itemsToDelete=[]},getItemTemplate:function(){return{account:null,floatAccount:null,costCenter:null,imprestSettlements:[]}},splitValue:function(){for(var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.sum,a={},i=0;i<this.factors.length;i++)if(a=t?this.factors[this.factors.length-i-1]:this.factors[i],e>0){var s=a.remain;e>=s?(a.payment.value=s,e-=s):(a.payment.value=e,e=0)}else a.payment.value=0},getRowTemplate:function(){return{value:0}},setItem:function(t){var e=this;this.rows=[],this.item=t,this.itemsToDelete=[],t.items.forEach((function(t){e.rows.push(e.copy(t))})),this.rows.push(this.getRowTemplate()),this.modalMode||this.changeRouteTo(t.id)}}},f=h,p=(a("46ba"),a("2877")),v=a("6544"),b=a.n(v),x=a("c6a6"),y=a("8336"),_=a("b0af"),g=a("99d9"),C=a("cc20"),q=a("62ad"),k=a("169a"),w=a("132d"),T=a("0fd9"),P=a("1f4f"),E=a("2fa4"),V=a("8654"),F=a("a844"),I=Object(p["a"])(f,i,s,!1,null,"7544b9a3",null);e["default"]=I.exports;b()(I,{VAutocomplete:x["a"],VBtn:y["a"],VCard:_["a"],VCardActions:g["a"],VCardText:g["b"],VCardTitle:g["c"],VChip:C["a"],VCol:q["a"],VDialog:k["a"],VIcon:w["a"],VRow:T["a"],VSimpleTable:P["a"],VSpacer:E["a"],VTextField:V["a"],VTextarea:F["a"]})},"3e2c":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",[a("v-card-title",[t._v("لیست "+t._s(t.options.label))]),a("v-card-text",{staticClass:"mt-2"},[t.showTable?a("m-datatable",{ref:"datatable",attrs:{headers:t.options.cols.concat(t.detailCol),apiUrl:t.options.url,filters:t.filters,"router-name":t.options.routerName,"router-default-params":t.options.defaultParams},on:{"update:filters":function(e){t.filters=e}},scopedSlots:t._u([{key:"item.detail",fn:function(e){var i=e.item;return[a("v-btn",{attrs:{color:"light-blue white--text",to:{name:t.options.routerName,params:Object.assign({},{id:i.id},t.options.defaultParams)},target:"_blank",icon:""}},[a("v-icon",[t._v("fa-external-link-alt")])],1)]}}],null,!1,2287926915)}):t._e()],1)],1)},s=[],n=a("5530"),o={url:"reports/lists/transactions",cols:[{text:"شماره",value:"code",type:"number",filters:["code__icontains"]},{text:"نام حساب",value:"account.name",type:"text",filters:["account__name__icontains"]},{text:"تاریخ",value:"date",type:"date",filters:[{label:"xxxx-xx-xx از تاریخ ",model:"date__gte"},{label:"xxxx-xx-xx تا تاریخ",model:"date__lte"}]},{text:"توضیحات",value:"explanation",type:"text",filters:["account__icontains"]},{text:"مبلغ مجموع",value:"sanad.bed",type:"money",filters:["sanad__bed__icontains"]}],routerName:"TransactionForm"},l={url:"reports/lists/cheques",routerName:"ChequeDetail",cols:[{text:"شماره",value:"serial"},{text:"شرح",value:"explanation"},{text:"تاریخ",value:"date"},{text:"تاریخ سررسید",value:"due"},{text:"مبلغ",value:"value"},{text:"نام حساب",value:"account.name"},{text:"وضعیت",value:"status",items:[{text:"سفید",value:"blank"},{text:"پاس نشده",value:"notPassed"},{text:"در جریان",value:"inFlow"},{text:"پاس شده",value:"passed"},{text:"برگشتی",value:"bounced"},{text:"نقدی",value:"cashed"},{text:"باطل شده",value:"revoked"},{text:"انتقالی",value:"transferred"}]},{text:"نام بانک",value:"bankName",type:"text",filters:["bankName__icontains"]}]},r={url:"reports/lists/chequebooks",routerName:"ChequebookForm",cols:[{text:"حساب",value:"account.name",type:"text",filters:["account__name__icontains"]},{text:"سری",value:"serial",type:"text",filters:["serial__icontains"]},{text:"از سریال",value:"serial_from",type:"number",filters:["serial__icontains"]},{text:"تا سریال",value:"serial_to",type:"number",filters:["serial__icontains"]},{text:"توضیحات",value:"explanation",type:"text",filters:["account__icontains"]}],label:"دسته چک ها"},c={url:"reports/lists/sanads",cols:[{text:"عطف",value:"id"},{text:"شماره",value:"code"},{text:"بدهکار",value:"bed"},{text:"بستانکار",value:"bes"},{text:"تاریخ",value:"date"},{text:"سیستمی",value:"is_auto_created",type:"boolean"},{text:"توضیحات",value:"explanation"}],label:"اسناد",routerName:"SanadForm"},u=Object(n["a"])({},c,{label:"اسناد نامتوازن",url:"reports/lists/sanads/unbalanced"}),d=Object(n["a"])({},c,{label:"اسناد خالی",url:"reports/lists/sanads/empty"}),m={url:"reports/lists/factors",routerName:"FactorForm",cols:[{text:"شماره",value:"code",type:"number",filters:["code__icontains"]},{text:"تاریخ",value:"date",type:"date",filters:[{label:"xxxx-xx-xx از تاریخ ",model:"date__gte"},{label:"xxxx-xx-xx تا تاریخ",model:"date__lte"}]},{text:"ساعت",value:"time",type:"time",filters:[{label:"از ساعت",model:"time__gte"},{label:"تا ساعت",model:"time__lte"}]},{text:"حساب",value:"account.name",type:"text",filters:["account__name__icontains"]},{text:"توضیحات",value:"explanation",type:"text",filters:["explanation__icontains"]},{text:"مبلغ کل فاکتور",value:"total_sum",type:"numeric",sortable:!1},{text:"قطعی",value:"is_definite",type:"boolean"},{text:"مالیات ",value:"has_tax",type:"boolean"}]},h={url:"reports/lists/receipts",routerName:"ReceiptAndRemittance",cols:[{text:"شماره",value:"code",type:"number",filters:["code__icontains"]},{text:"تاریخ",value:"date",type:"date",filters:[{label:"xxxx-xx-xx از تاریخ ",model:"date__gte"},{label:"xxxx-xx-xx تا تاریخ",model:"date__lte"}]},{text:"ساعت",value:"time",type:"time",filters:[{label:"از ساعت",model:"time__gte"},{label:"تا ساعت",model:"time__lte"}]},{text:"توضیحات",value:"explanation",type:"text",filters:["explanation__icontains"]}]},f={url:"reports/lists/transfers",routerName:"TransferForm",cols:[{text:"شماره",value:"code",type:"number"},{text:"تاریخ",value:"date",type:"date"},{text:"توضیحات",value:"explanation",type:"text"}]},p={url:"reports/lists/adjustments",routerName:"AdjustmentForm",cols:[{text:"شماره",value:"code",type:"number"},{text:"تاریخ",value:"date",type:"date"},{text:"توضیحات",value:"explanation",type:"text"}]},v={transaction:o,cheque:l,chequebook:r,sanad:c,sanadUnbalanced:u,sanadEmpty:d,factor:m,receipt:h,transfer:f,adjustment:p},b={name:"List",props:{form:{required:!0},type:{}},data:function(){return{formOptions:v,options:{},showTable:!1,filters:{},detailCol:{text:"",value:"detail",sortable:!1,filterable:!1}}},created:function(){this.init()},methods:{init:function(){switch(this.log("init list"),this.showTable=!1,this.options=this.formOptions[this.form],this.type){case"ia":this.options.label="رسید های تعدیل انبار",this.filters={type:this.type},this.options.defaultParams=this.filters;break;case"oa":this.options.label="حواله های تعدیل انبار",this.filters={type:this.type},this.options.defaultParams=this.filters;break;case"receive":this.options.label="دریافت ها",this.filters={transactionType:this.type},this.options.defaultParams=this.filters;break;case"payment":this.options.label="پرداخت ها",this.filters={transactionType:this.type},this.options.defaultParams=this.filters;break;case"imprest":this.options.label="پرداخت های تنخواه",this.filters={transactionType:this.type},this.options.defaultParams=this.filters;break;case"received":this.options.label="چک های دریافتنی",this.filters={received_or_paid:"r"};break;case"paid":this.options.label="چک های پرداختنی",this.filters={received_or_paid:"p"};break;default:break}if("factor"==this.form)switch(this.filters={type:this.type},this.options.defaultParams={type:this.type},this.type){case"buy":this.options.label="فاکتور های خرید";break;case"backFromBuy":this.options.label="فاکتور های برگشت از خرید";break;case"sale":this.options.label="فاکتور های فروش";break;case"backFromSale":this.options.label="فاکتور های برگشت از فروش";break}if("receipt"==this.form)switch(filters={receiptType:this.type},this.filters=filters,this.options.defaultParams=filters,this.type){case"receipt":this.options.label="رسید ها";break;case"remittance":this.options.label="حواله ها";break}this.showTable=!0,this.filters=Object(n["a"])({},this.filters,{},this.$route.query)}},watch:{form:function(){this.init()},type:function(){this.init()},urlQuery:function(){this.init()}}},x=b,y=a("2877"),_=a("6544"),g=a.n(_),C=a("8336"),q=a("b0af"),k=a("99d9"),w=a("132d"),T=Object(y["a"])(x,i,s,!1,null,"ac1b2524",null);e["default"]=T.exports;g()(T,{VBtn:C["a"],VCard:q["a"],VCardText:k["b"],VCardTitle:k["c"],VIcon:w["a"]})},4633:function(t,e,a){"use strict";var i=a("ae79");e["a"]={components:{OpenSanadBtn:i["a"]},data:function(){return{editable:!1}},created:function(){this.setEditable()},watch:{id:function(){this.setEditable()}},methods:{setEditable:function(){this.id?this.editable=!1:this.editable=!0},makeFormEditable:function(){this.editable=!0},makeFormUneditable:function(){this.editable=!1}}}},"46ba":function(t,e,a){"use strict";var i=a("848c"),s=a.n(i);s.a},"47aa":function(t,e,a){"use strict";a("2ef0");e["a"]={data:function(){return{}},methods:{getCheque:function(t){var e=this;return this.request({url:this.endpoint("cheques/cheques/".concat(t)),method:"get",success:function(t){e.setItem(t)}})}}}},"848c":function(t,e,a){},"8a10":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("m-form",{attrs:{title:t.title,showListBtn:!1,showList:!1,listRoute:{name:"List",params:{form:"cheque",type:"p"==this.receivedOrPaid?"paid":"received"}},showNavigationButtons:!t.modalMode,showSubmitAndClearForm:!t.modalMode,canDelete:t.canDelete,canSubmit:t.canSubmit,isEditing:t.isEditing,confirmBtnText:t.confirmBtnText,cancelConfirmBtnText:t.cancelConfirmBtnText,canConfirm:t.canConfirm,canCancelConfirm:t.canCancelConfirm},on:{"update:isEditing":function(e){t.isEditing=e},"update:is-editing":function(e){t.isEditing=e},cancelConfirm:t.cancelConfirm,confirm:t.confirm,clearForm:t.clearForm,goToForm:t.getItemByPosition,submit:t.validate,delete:t.deleteItem},scopedSlots:t._u([{key:"header-btns",fn:function(){return[t.id?a("v-btn",{staticClass:"blue white--text mr-1",attrs:{to:{name:"ChequeDetail",id:t.id}}},[t._v("مشاهده جزئیات چک")]):t._e()]},proxy:!0}])},[[a("v-row",[t.isPaidCheque?[a("v-col",{attrs:{cols:"12",md:"3"}},[a("v-autocomplete",{attrs:{"return-object":!0,required:"",label:" * دسته چک",items:t.chequebooks,"item-text":"account.name","item-value":"id",disabled:null!=t.id||!t.isEditing},on:{change:t.getPaidCheques},model:{value:t.item.chequebook,callback:function(e){t.$set(t.item,"chequebook",e)},expression:"item.chequebook"}})],1),a("v-col",{attrs:{cols:"12",md:"3"}},[a("v-autocomplete",{attrs:{"return-object":!0,required:"",disabled:!t.chequebook||!t.isEditing,label:" * چک",items:t.paidCheques,"item-text":"serial","item-value":"id"},on:{change:function(e){t.item&&(t.item.account=null)}},model:{value:t.item,callback:function(e){t.item=e},expression:"item"}})],1)]:a("v-col",{attrs:{cols:"12",md:"3"}},[a("v-text-field",{attrs:{required:"",label:" * سریال چک",disabled:t.isPaidCheque||!t.isEditing},model:{value:t.item.serial,callback:function(e){t.$set(t.item,"serial",e)},expression:"item.serial"}})],1),a("v-col",{attrs:{cols:"12",md:"6"}},[a("account-select",{attrs:{label:" * "+(t.isPaidCheque?"دریافت کننده":"پرداخت کننده"),"items-type":"level3",disabled:t.modalMode||!t.isEditing,floatAccount:t.item.floatAccount,costCenter:t.item.costCenter},on:{"update:floatAccount":function(e){return t.item.floatAccount=e},"update:costCenter":function(e){return t.item.costCenter=e}},model:{value:t.item.account,callback:function(e){t.$set(t.item,"account",e)},expression:"item.account"}})],1),a("v-col",{attrs:{cols:"12",md:"2"}},[a("money",{attrs:{label:" * مبلغ",disabled:!t.isEditing},model:{value:t.item.value,callback:function(e){t.$set(t.item,"value",e)},expression:"item.value"}})],1),a("v-col",{attrs:{cols:"12",md:"2"}},[a("date",{attrs:{label:" * تاریخ سررسید",default:!1,disabled:!t.isEditing},model:{value:t.item.due,callback:function(e){t.$set(t.item,"due",e)},expression:"item.due"}})],1),a("v-col",{attrs:{cols:"12",md:"2"}},[a("date",{attrs:{label:"* تاریخ ثبت",default:!0,disabled:!t.isEditing},model:{value:t.item.date,callback:function(e){t.$set(t.item,"date",e)},expression:"item.date"}})],1),t.canSetSanadCode?a("v-col",{attrs:{cols:"12",md:"2"}},[a("v-text-field",{attrs:{label:"شماره سند",disabled:!t.isEditing},model:{value:t.item.sanad_code,callback:function(e){t.$set(t.item,"sanad_code",e)},expression:"item.sanad_code"}})],1):t._e(),a("v-col",{attrs:{cols:"12",md:"4"}},[a("v-textarea",{attrs:{label:"شرح چک",disabled:!t.isEditing},model:{value:t.item.explanation,callback:function(e){t.$set(t.item,"explanation",e)},expression:"item.explanation"}})],1),t.isPaidCheque?t._e():a("v-col",{attrs:{cols:"12",md:"12"}},[a("v-select",{attrs:{label:" * نوع چک",items:t.chequeTypes,"item-text":"label","item-value":"value","return-object":!1,disabled:!t.isEditing},model:{value:t.item.type,callback:function(e){t.$set(t.item,"type",e)},expression:"item.type"}})],1),a("v-col",{attrs:{cols:"12",md:"4"}},[a("v-text-field",{attrs:{label:"نام بانک",disabled:t.isPaidCheque||!t.isEditing},model:{value:t.item.bankName,callback:function(e){t.$set(t.item,"bankName",e)},expression:"item.bankName"}})],1),a("v-col",{attrs:{cols:"12",md:"4"}},[a("v-text-field",{attrs:{label:"نام شعبه",disabled:t.isPaidCheque||!t.isEditing},model:{value:t.item.branchName,callback:function(e){t.$set(t.item,"branchName",e)},expression:"item.branchName"}})],1),a("v-col",{attrs:{cols:"12",md:"4"}},[a("v-text-field",{attrs:{label:"شماره حساب چک",disabled:t.isPaidCheque||!t.isEditing},model:{value:t.item.accountNumber,callback:function(e){t.$set(t.item,"accountNumber",e)},expression:"item.accountNumber"}})],1)],2)]],2),a("form-list",{ref:"formList",staticClass:"mt-3",attrs:{form:"cheque",type:t.isPaidCheque?"paid":"received"}})],1)},s=[],n=a("a49f"),o=a("3c1f"),l=a("0359"),r=a("47aa"),c=a("3e2c"),u=a("4633"),d=a("e5c3"),m=a("da4b"),h={name:"ChequeForm",props:{receivedOrPaid:{requried:!0},id:{default:null},modalMode:{default:!1}},components:{money:o["a"],date:l["a"],FormList:c["default"]},mixins:[r["a"],n["a"],u["a"],d["a"],m["b"]],data:function(){return{baseUrl:"cheques/cheques",hasList:!1,hasIdProp:!0,chequebook:{},cheque:{received_or_paid:this.receivedOrPaid,account:null},paidCheques:[],chequeTypes:[{label:"شخصی",value:"p"},{label:"شخصی سایرین",value:"op"},{label:"شرکت",value:"c"},{label:"شرکت سایرین",value:"oc"}]}},computed:{createUrl:function(){return"cheques/cheques/submit/"},permissionBasename:function(){return this.isPaidCheque?"paidCheque":"receivedCheque"},isPaidCheque:function(){return"p"==this.receivedOrPaid},title:function(){var t="چک ";return this.isPaidCheque?t+="پرداختی":t+="دریافتی",t},canSetSanadCode:function(){var t=this.item.statusChanges;return!t||0==t.length},canDelete:function(){if(this.isPaidCheque)return!1;if(this.item.id){var t=this.item.statusChanges.length;if(this.isPaidCheque){if(0==t)return!0}else if(1==t)return!0;return!1}return!1}},created:function(){this.getAccounts(),this.id&&this.getCheque(this.id),this.isPaidCheque&&this.getChequebooks()},methods:{getData:function(){this.$refs.formList&&this.$refs.formList.$refs.datatable.getData()},validate:function(t){this.modalMode?this.$emit("submit",this.extractIds(this.item)):this.submit(t)},getItemTemplate:function(){return{account:null,floatAccount:null,costCenter:null,received_or_paid:this.receivedOrPaid}},getItemByPosition:function(t){var e=this;return this.request({url:this.endpoint("cheques/getChequeByPosition"),method:"get",params:{received_or_paid:this.receivedOrPaid,id:this.id,position:t},success:function(t){e.setItem(t)},error:function(t){404==t.response.status&&e.notify("چک وجود ندارد","warning")}})},setItem:function(t){this.id!=t.id&&this.changeRouteTo(t.id),this.item=t,this.getPaidCheques(),this.isEditing=!1},getPaidCheques:function(){var t=this;this.paidCheques=[];var e={chequebook__id:this.chequebook.id};void 0==this.id&&(e["status"]="blank"),this.request({url:this.endpoint("reports/lists/cheques"),method:"get",loading:!1,params:e,success:function(e){t.paidCheques=e}})}}},f=h,p=a("2877"),v=a("6544"),b=a.n(v),x=a("c6a6"),y=a("8336"),_=a("62ad"),g=a("0fd9"),C=a("b974"),q=a("8654"),k=a("a844"),w=Object(p["a"])(f,i,s,!1,null,"5503af9b",null);e["default"]=w.exports;b()(w,{VAutocomplete:x["a"],VBtn:y["a"],VCol:_["a"],VRow:g["a"],VSelect:C["a"],VTextField:q["a"],VTextarea:k["a"]})},e5c3:function(t,e,a){"use strict";var i=a("5530"),s=a("2f62");e["a"]={data:function(){return{}},methods:{getChequebooks:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e||!this.chequebooks.length)return this.request({url:this.endpoint("cheques/chequebooks/"),method:"get",success:function(e){t.$store.commit("setChequebooks",e)}})}},computed:Object(i["a"])({},Object(s["b"])({chequebooks:function(t){return t.chequebooks}}))}}}]);
//# sourceMappingURL=chunk-7f6ce520.c89e1739.js.map