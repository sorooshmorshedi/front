(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d21f2c6"],{d961:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("m-form",{attrs:{title:"تحویل فاکتور ها جهت توزیع",showList:!1,listRoute:{name:"DistributionsList"},exportBaseUrl:"reports/lists/distributions",exportParams:{id:this.id},canDelete:!1,canSubmit:t.canSubmit,isEditing:t.isEditing},on:{"update:isEditing":function(e){t.isEditing=e},"update:is-editing":function(e){t.isEditing=e},goToForm:t.getItemByPosition,submit:t.submit,delete:t.deleteItem,clearForm:function(e){return t.clearForm()}},scopedSlots:t._u([{key:"header-btns",fn:function(){return[s("v-btn",{staticClass:"mr-1 rounded-lg",attrs:{depressed:"",color:"primary white--text",to:{name:"DistributionRemittance",params:{id:t.id}}}},[t._v("حواله توزیع ")])]},proxy:!0}])},[[s("v-row",[s("v-col",{attrs:{cols:"12",md:"2"}},[s("v-text-field",{staticClass:"rounded-lg",attrs:{disabled:"",label:"عطف","background-color":"white"},model:{value:t.item.local_id,callback:function(e){t.$set(t.item,"local_id",e)},expression:"item.local_id"}})],1),s("v-col",{attrs:{cols:"12",md:"2"}},[s("v-text-field",{staticClass:"rounded-lg",attrs:{disabled:"",label:"شماره","background-color":"white"},model:{value:t.item.code,callback:function(e){t.$set(t.item,"code",e)},expression:"item.code"}})],1),s("v-col",{attrs:{cols:"12",md:"2"}},[s("date",{attrs:{label:" * تاریخ ",default:!0,disabled:!t.isEditing},model:{value:t.item.date,callback:function(e){t.$set(t.item,"date",e)},expression:"item.date"}})],1),s("v-col",{attrs:{cols:"12",md:"2"}},[s("mtime",{attrs:{label:" * ساعت",default:!0,disabled:!t.isEditing},model:{value:t.item.time,callback:function(e){t.$set(t.item,"time",e)},expression:"item.time"}})],1),s("v-col",{attrs:{cols:"12",md:"4"}},[s("v-autocomplete",{staticClass:"rounded-lg",attrs:{label:"* ماشین",items:t.cars,"item-text":"car_number","item-value":"id",disabled:!t.isEditing},model:{value:t.item.car,callback:function(e){t.$set(t.item,"car",e)},expression:"item.car"}})],1),s("v-col",{attrs:{cols:"12",md:"8"}},[s("v-textarea",{staticClass:"rounded-lg",attrs:{label:"توضیحات",disabled:!t.isEditing},model:{value:t.item.explanation,callback:function(e){t.$set(t.item,"explanation",e)},expression:"item.explanation"}})],1),s("v-col",{attrs:{cols:"12",md:"4"}},[t.item.created_by?s("v-text-field",{staticClass:"rounded-lg",attrs:{label:"کاربر",disabled:""},model:{value:t.item.created_by.name,callback:function(e){t.$set(t.item.created_by,"name",e)},expression:"item.created_by.name"}}):t._e()],1),t.id?s("v-col",{attrs:{cols:"12"}},[t.isEditing?s("v-card-subtitle",[t._v("فاکتور های فعلی (برای حذف فاکتور آن را از انتخاب خارج کنید) ")]):t._e(),s("m-datatable",{ref:"datatable",attrs:{headers:t.selectedFactorsHeaders,filters:t.filters,showExportBtns:!1,items:t.item.factors},on:{"update:filters":function(e){t.filters=e}},scopedSlots:t._u([{key:"item.payable_value",fn:function(e){var s=e.item;return[t._v(t._s(t._f("toMoney")(t.getFactorPayableValue(s))))]}},{key:"item.operations",fn:function(e){var i=e.item;return[s("div",{staticClass:"pa-1"},[s("v-btn",{attrs:{"x-small":"",depressed:"",color:"success rounded-lg white--text",block:"",to:t.getFactorTransactionLink(i).to}},[t._v("ثبت دریافت ")]),s("v-btn",{staticClass:"mt-1",attrs:{depressed:"",block:"",color:"error rounded-lg white--text",to:t.getReverseFactorLink(i).to}},[t._v("ثبت برگشت از فروش ")])],1)]}},{key:"item.status",fn:function(e){var i=e.item;return[s("v-btn",{attrs:{disabled:null!=i.backFactor,block:"","x-small":"",depressed:"",color:"danger rounded-lg white--text"}},[t._v("مرجوع کامل ")]),s("v-btn",{staticClass:"mt-1",attrs:{block:"","x-small":"",depressed:"",color:"blue white--text"}},[t._v("تحویل شد")])]}}],null,!1,1104207636),model:{value:t.factors,callback:function(e){t.factors=e},expression:"factors"}})],1):t._e(),t.isEditing?[t.id?s("v-col",{attrs:{cols:"12"}},[s("v-card-subtitle",[t._v("فاکتور هایی که میخواهید اضافه کنید از لیست پایین انتخاب کنید")])],1):t._e(),s("v-col",{staticClass:"py-1",attrs:{cols:"12"}},[s("tree-select",{attrs:{levelsCount:5,items:t.paths,labels:t.PathLevels,itemsIn:t.filters.path__in,"item-text":"name"},on:{"update:itemsIn":function(e){return t.$set(t.filters,"path__in",e)},"update:items-in":function(e){return t.$set(t.filters,"path__in",e)}}})],1),s("v-col",{staticClass:"py-1",attrs:{cols:"12"}},[s("tree-select",{attrs:{levelsCount:4,items:t.visitors,labels:t.VisitorLevels,itemsIn:t.filters.visitor__in,"item-text":"user.name"},on:{"update:itemsIn":function(e){return t.$set(t.filters,"visitor__in",e)},"update:items-in":function(e){return t.$set(t.filters,"visitor__in",e)}}})],1),s("v-col",{staticClass:"py-1",attrs:{cols:"12"}},[s("m-datatable",{ref:"datatable",attrs:{headers:t.headers,filters:t.filters,showExportBtns:!1,apiUrl:"reports/lists/factors"},on:{"update:filters":function(e){t.filters=e}},model:{value:t.factors,callback:function(e){t.factors=e},expression:"factors"}})],1)]:t._e()],2)]],2)},a=[],l=(s("99af"),s("4de4"),s("d81d"),s("b0c0"),s("2909")),r=s("b7e5"),o=s("923b"),n=s("1276"),c=s("4633"),d=s("14a8"),u=s("53c2"),m=s("7eac"),f={name:"DistributionForm",mixins:[r["b"],o["a"],c["a"],d["a"]],components:{mtime:n["a"],TreeSelect:u["a"]},props:{id:{}},data:function(){return{baseUrl:"distributions/distributions",permissionBasename:"distributions",appendSlash:!0,hasList:!1,hasIdProp:!0,filters:{type:"sale",is_defined:!0,is_loaded:!1},factors:[],factor:null,isFullDelivery:null,PathLevels:m["b"],VisitorLevels:m["c"]}},computed:{headers:function(){return[{text:"شماره",value:"code"},{text:"تاریخ",value:"date",type:"date"},{text:"خریدار",value:"account.name"},{text:"شرح",value:"explanation"},{text:"مبلغ کل فاکتور",value:"total_sum",type:"numeric"},{text:"مبلغ برگشتی",value:"backFactor.total_sum",type:"numeric"},{text:"مبلغ دریافت شده",value:"paidValue",type:"numeric"},{text:"مبلغ قابل دریافت",value:"payable_value"},{text:"ویزیتور",value:"visitor",items:this.visitors.filter((function(t){return 3==t.level})).map((function(t){return{text:t.user.name,value:t.id}})),itemText:"user.name",itemValue:"id"}]},selectedFactorsHeaders:function(){return[].concat(Object(l["a"])(this.headers),[{text:"عملیات ها",value:"operations"},{text:"ثبت وضعیت",value:"status"}])}},methods:{getItemTemplate:function(){return{factors:[]}},getItemByPosition:function(t){var e=this;return this.request({url:this.endpoint("".concat(this.baseUrl,"/byPosition")),method:"get",params:{id:this.item.id,position:t},success:function(t){e.setItem(t)}})},getData:function(){this.getCars(),this.getVisitors(),this.getPaths()},setItem:function(t){this.item=t,this.changeRouteTo(t.id),this.factors=this.copy(t.factors)},getSerialized:function(){var t=this.extractIds(this.item);return t.factors=this.factors.map((function(t){return t.id})),t}}},b=f,v=s("2877"),p=s("6544"),x=s.n(p),h=s("c6a6"),_=s("8336"),g=s("99d9"),y=s("62ad"),k=s("0fd9"),w=s("8654"),C=s("a844"),E=Object(v["a"])(b,i,a,!1,null,"0368e002",null);e["default"]=E.exports;x()(E,{VAutocomplete:h["a"],VBtn:_["a"],VCardSubtitle:g["b"],VCol:y["a"],VRow:k["a"],VTextField:w["a"],VTextarea:C["a"]})}}]);
//# sourceMappingURL=chunk-2d21f2c6.1450ee4e.js.map