(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d21f2c6"],{d961:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("m-form",{attrs:{title:"تحویل فاکتور ها جهت توزیع",showList:!1,listRoute:{name:"DistributionsList"},exportBaseUrl:"reports/lists/distributions",exportParams:{id:this.id},canDelete:!1,canSubmit:e.canSubmit,isEditing:e.isEditing,confirmBtnText:e.confirmBtnText,cancelConfirmBtnText:e.cancelConfirmBtnText,canConfirm:e.canConfirm,canCancelConfirm:e.canCancelConfirm},on:{"update:isEditing":function(t){e.isEditing=t},"update:is-editing":function(t){e.isEditing=t},cancelConfirm:e.cancelConfirm,confirm:e.confirm,goToForm:e.getItemByPosition,submit:e.submit,delete:e.deleteItem,clearForm:function(t){return e.clearForm()}},scopedSlots:e._u([{key:"header-btns",fn:function(){},proxy:!0}])},[[i("v-row",[i("v-col",{attrs:{cols:"12",md:"2"}},[i("v-text-field",{attrs:{disabled:"",label:"عطف","background-color":"white"},model:{value:e.item.local_id,callback:function(t){e.$set(e.item,"local_id",t)},expression:"item.local_id"}})],1),i("v-col",{attrs:{cols:"12",md:"2"}},[i("v-text-field",{attrs:{disabled:"",label:"شماره","background-color":"white"},model:{value:e.item.code,callback:function(t){e.$set(e.item,"code",t)},expression:"item.code"}})],1),i("v-col",{attrs:{cols:"12",md:"2"}},[i("date",{attrs:{label:" * تاریخ ",default:!0,disabled:!e.isEditing},model:{value:e.item.date,callback:function(t){e.$set(e.item,"date",t)},expression:"item.date"}})],1),i("v-col",{attrs:{cols:"12",md:"2"}},[i("mtime",{attrs:{label:" * ساعت",default:!0,disabled:!e.isEditing},model:{value:e.item.time,callback:function(t){e.$set(e.item,"time",t)},expression:"item.time"}})],1),i("v-col",{attrs:{cols:"12",md:"4"}},[i("v-autocomplete",{attrs:{label:"* ماشین",items:e.cars,"item-text":"car_number","item-value":"id",disabled:!e.isEditing},model:{value:e.item.car,callback:function(t){e.$set(e.item,"car",t)},expression:"item.car"}})],1),i("v-col",{attrs:{cols:"12",md:"8"}},[i("v-textarea",{attrs:{label:"توضیحات",disabled:!e.isEditing},model:{value:e.item.explanation,callback:function(t){e.$set(e.item,"explanation",t)},expression:"item.explanation"}})],1),i("v-col",{attrs:{cols:"12",md:"4"}},[e.item.created_by?i("v-text-field",{attrs:{label:"کاربر",disabled:""},model:{value:e.item.created_by.name,callback:function(t){e.$set(e.item.created_by,"name",t)},expression:"item.created_by.name"}}):e._e()],1),e.isEditing?[i("v-col",{attrs:{cols:"12"}},[i("tree-select",{attrs:{levelsCount:5,items:e.paths,labels:e.PathLevels,itemsIn:e.filters.path__in,"item-text":"name"},on:{"update:itemsIn":function(t){return e.$set(e.filters,"path__in",t)},"update:items-in":function(t){return e.$set(e.filters,"path__in",t)}}})],1),i("v-col",{attrs:{cols:"12"}},[i("tree-select",{attrs:{levelsCount:4,items:e.visitors,labels:e.VisitorLevels,itemsIn:e.filters.visitor__in,"item-text":"user.name"},on:{"update:itemsIn":function(t){return e.$set(e.filters,"visitor__in",t)},"update:items-in":function(t){return e.$set(e.filters,"visitor__in",t)}}})],1),i("v-col",{attrs:{cols:"12"}},[i("m-datatable",{ref:"datatable",attrs:{headers:e.headers,filters:e.filters,showExportBtns:!1,apiUrl:"reports/lists/factors"},on:{"update:filters":function(t){e.filters=t}},model:{value:e.factors,callback:function(t){e.factors=t},expression:"factors"}})],1)]:i("v-col",{attrs:{cols:"12"}},[i("m-datatable",{ref:"datatable",attrs:{headers:e.headers,filters:e.filters,showExportBtns:!1,items:e.item.factors},on:{"update:filters":function(t){e.filters=t}},model:{value:e.factors,callback:function(t){e.factors=t},expression:"factors"}})],1)],2)]],2)},n=[],a=(i("4de4"),i("d81d"),i("b0c0"),i("da4b")),l=i("923b"),r=i("12761"),o=i("4633"),c=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-row",{attrs:{"no-gutters":""}},e._l(e.levelsCount,(function(t,s){return i("v-col",{key:s,class:0!=s?"pr-3":"pr-0"},[0==s||e.selectedLevels[s-1]&&e.selectedLevels[s-1].length?i("v-autocomplete",{attrs:{label:e.getTitle(s),items:e.getItems(s),"item-text":e.levelText,"item-value":"id",multiple:!0,clearable:!0,"small-chips":!0,"deletable-chips":!0,"return-object":!0},on:{input:function(t){return e.emit(s)},"click:clear":function(t){return e.emit(s)}},model:{value:e.selectedLevels[s],callback:function(t){e.$set(e.selectedLevels,s,t)},expression:"selectedLevels[i]"}}):e._e()],1)})),1)},u=[],d=(i("99af"),i("7db0"),i("a15b"),i("13d5"),i("ac1f"),i("1276"),i("2ca0"),i("2909")),m=i("b85c"),f=i("5530"),v=i("7eac"),p={name:"TreeSelect",props:{levelsCount:{require:!0},items:{require:!0},labels:{require:!0},itemText:{default:"text"},itemsIn:{}},data:function(){return{selectedLevels:[]}},created:function(){for(var e=[],t=0;t<this.levelsCount;t++)e.push([]);this.$set(this,"selectedLevels",e)},computed:{nodes:function(){return this.buildTree(this.items)},levelText:function(){return"title"}},methods:{buildTree:function(e){var t=this,i=this.copy(e);i=i.map((function(e){return Object(f["a"])({children:[],title:t.getItemText(e)},e)}));var s,n=Object(m["a"])(i);try{var a=function(){var e=s.value,n=i.find((function(t){return t.id==e.parent}));n&&(e.title="".concat(t.getItemText(e)," > ").concat(t.getItemText(e)),n.children.push(e))};for(n.s();!(s=n.n()).done;)a()}catch(r){n.e(r)}finally{n.f()}var l=i.filter((function(e){return!e.parent}));return l},getTitle:function(e){return Object(v["d"])(this.labels,e)},getItems:function(e){if(0==e)return this.nodes;var t=[],i=this.selectedLevels[e-1];if(i){var s,n=Object(m["a"])(this.selectedLevels[e-1]);try{for(n.s();!(s=n.n()).done;){var a=s.value;t.push.apply(t,Object(d["a"])(a.children))}}catch(l){n.e(l)}finally{n.f()}}return t},clearSelectedLevels:function(e){for(var t=e+1;t<this.levelsCount;t++)this.selectedLevels[t]=null},emit:function(e){var t=this;this.clearSelectedLevels(e);var i=[];if(e==this.levelsCount-1)i=this.selectedLevels[e];else{var s=this.selectedLevels[e];i=this.items.filter((function(e){return e.level==t.levelsCount-1})).filter((function(e){var t,i=Object(m["a"])(s);try{for(i.s();!(t=i.n()).done;){var n=t.value;if(e.code.startsWith(n.code))return!0}}catch(a){i.e(a)}finally{i.f()}return!1}))}this.$emit("update:itemsIn",i.map((function(e){return e.id})).join(","))},getItemText:function(e){var t=this.itemText.split(".").reduce((function(e,t){return e?e[t]:null}),e);return t}}},h=p,b=i("2877"),x=i("6544"),g=i.n(x),_=i("c6a6"),T=i("62ad"),y=i("0fd9"),C=Object(b["a"])(h,c,u,!1,null,null,null),L=C.exports;g()(C,{VAutocomplete:_["a"],VCol:T["a"],VRow:y["a"]});var I={name:"DistributionForm",mixins:[a["b"],l["a"],o["a"]],components:{mtime:r["a"],TreeSelect:L},props:{id:{}},data:function(){return{baseUrl:"distributions/distributions",permissionBasename:"distributions",appendSlash:!0,hasList:!1,hasIdProp:!0,filters:{type:"sale",is_definite:!0,is_loaded:!1},factors:[],PathLevels:v["b"],VisitorLevels:v["c"]}},computed:{headers:function(){return[{text:"شماره",value:"code"},{text:"تاریخ",value:"date",type:"date"},{text:"خریدار",value:"account.name"},{text:"شرح",value:"explanation"},{text:"مبلغ کل فاکتور",value:"total_sum",type:"numeric"},{text:"ویزیتور",value:"visitor",items:this.visitors.filter((function(e){return 3==e.level})).map((function(e){return{text:e.user.name,value:e.id}})),itemText:"user.name",itemValue:"id"}]}},methods:{getItemTemplate:function(){return{factors:[]}},getItemByPosition:function(e){var t=this;return this.request({url:this.endpoint("".concat(this.baseUrl,"/byPosition/")),method:"get",params:{id:this.item.id,position:e},success:function(e){t.setItem(e)}})},getData:function(){this.getCars(),this.getVisitors(),this.getPaths()},setItem:function(e){this.item=e,this.changeRouteTo(e.id),this.factors=this.copy(e.factors)},getSerialized:function(){var e=this.extractIds(this.item);return e.factors=this.factors.map((function(e){return e.id})),e}}},k=I,$=i("8654"),w=i("a844"),E=Object(b["a"])(k,s,n,!1,null,"5ab3157d",null);t["default"]=E.exports;g()(E,{VAutocomplete:_["a"],VCol:T["a"],VRow:y["a"],VTextField:$["a"],VTextarea:w["a"]})}}]);
//# sourceMappingURL=chunk-2d21f2c6.a6b7a33e.js.map